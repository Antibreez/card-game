{"version":3,"sources":["node_modules/browser-pack/_prelude.js","source/js/main.js","source/js/modules/card.js","source/js/modules/constants.js","source/js/modules/game.js","source/js/utils/random.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import Game from './modules/game.js';\n\nconst game = new Game();\n","const $cardTemplate = document.getElementById(`card`)\n  .content\n  .querySelector(`.card`);\n\nclass Card {\n  constructor(name) {\n    this.name = name;\n  }\n\n  getCard() {\n    const node = $cardTemplate.cloneNode(true);\n    node.querySelector(`.card__img`).src = `img/${this.name}`;\n    return node;\n  }\n}\n\nexport default Card;\n","export const IMAGES_NAMES = [\n  `apple.svg`,\n  `ball.svg`,\n  `banana.svg`,\n  `cake.svg`,\n  `car.svg`,\n  `cat.svg`,\n  `cloud.svg`,\n  `dog.svg`,\n  `duck.svg`,\n  `earth.svg`,\n  `ferris.svg`,\n  `frig.svg`,\n  `flag.svg`,\n  `frog.svg`,\n  `hat.svg`,\n  `hot-dog.svg`,\n  `house.svg`,\n  `leaf.svg`,\n  `lightning.svg`,\n  `moon.svg`,\n  `mustache.svg`,\n  `rainbow.svg`,\n  `road.svg`,\n  `rocket.svg`,\n  `ship.svg`,\n  `smile.svg`,\n  `star.svg`,\n  `sun.svg`,\n  `tree.svg`,\n  `t-shirt.svg`,\n  `tv-screen.svg`,\n  `umbrella.svg`\n];\n","import {IMAGES_NAMES} from './constants.js';\nimport {getShuffledArr} from '../utils/random.js';\nimport Card from './card.js';\n\nconst $menu = document.getElementById(`menu`);\nconst $menuForm = document.getElementById(`menu-form`);\nconst $sizesRadio = $menuForm.querySelectorAll(`input[name='fieldSize']`);\nconst $cardBlock = document.getElementById(`card-block`);\n\nclass Game {\n  constructor() {\n    this.size = 4;\n    this.isOddMove = true;\n    this.firstCard = {};\n    this.isDebounce = false;\n    this.addEventListeners();\n  }\n\n  addCards() {\n    $cardBlock.innerHTML = ``;\n    const x = this.size;\n    const shuffledArr = getShuffledArr(IMAGES_NAMES).slice(0, x * x / 2);\n    const cardsArr = [];\n    shuffledArr.forEach((name, idx) => {\n      const card = new Card(name).getCard();\n      card.setAttribute(`data-pairId`, idx);\n      cardsArr.push(card);\n      const copyCard = card.cloneNode(true);\n      cardsArr.push(copyCard);\n    });\n\n    const fragment = document.createDocumentFragment();\n    getShuffledArr(cardsArr).forEach((card, idx) => {\n      card.setAttribute(`data-id`, idx);\n      fragment.appendChild(card);\n    });\n\n    $cardBlock.appendChild(fragment);\n    $cardBlock.classList.add(`size-${x}`);\n  }\n\n  onCardClick(e) {\n    const card = e.currentTarget;\n\n    if (card.classList.contains(`done`)) {\n      return;\n    }\n\n    if (this.isDebounce === true) {\n      return;\n    }\n\n    if (this.isOddMove) {\n      this.firstCard = card;\n      card.classList.add(`done`);\n      this.isOddMove = false;\n      this.makeDebounce(600);\n    } else {\n      card.classList.add(`done`);\n      if (card.getAttribute(`data-pairid`) !== this.firstCard.getAttribute(`data-pairid`)) {\n        this.hideBothCards(card);\n        this.makeDebounce(1200);\n      } else {\n        this.makeDebounce(600);\n        card.classList.add(`opened`);\n        this.firstCard.classList.add(`opened`);\n      }\n      this.isOddMove = true;\n    }\n  }\n\n  makeDebounce(time) {\n    this.isDebounce = true;\n\n    setTimeout(() => {\n      this.isDebounce = false;\n    }, time);\n  }\n\n  hideBothCards(currentCard) {\n    return setTimeout(() => {\n      currentCard.classList.remove(`done`);\n      this.firstCard.classList.remove(`done`);\n    }, 600);\n  }\n\n  getCardById(id) {\n    return $cardBlock.querySelectorAll(`.card`)[id];\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    $sizesRadio.forEach((sizeRadio) => {\n      if (sizeRadio.checked) {\n        this.size = +sizeRadio.value;\n      }\n    });\n\n    this.addCards();\n    this.addCardsEventListeners();\n    $menu.classList.add(`hidden`);\n  }\n\n  addCardsEventListeners() {\n    $cardBlock.querySelectorAll(`.card`).forEach((card) => {\n      card.addEventListener(`click`, this.onCardClick.bind(this));\n    });\n  }\n\n  addEventListeners() {\n    $menuForm.addEventListener(`submit`, this.onSubmit.bind(this));\n  }\n}\n\nexport default Game;\n","export const getShuffledArr = (arr) => {\n  return arr.sort(function () {\n    return Math.random() - 0.5;\n  });\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzb3VyY2UvanMvbWFpbi5qcyIsInNvdXJjZS9qcy9tb2R1bGVzL2NhcmQuanMiLCJzb3VyY2UvanMvbW9kdWxlcy9jb25zdGFudHMuanMiLCJzb3VyY2UvanMvbW9kdWxlcy9nYW1lLmpzIiwic291cmNlL2pzL3V0aWxzL3JhbmRvbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7Ozs7QUFFQSxJQUFNLElBQUksR0FBRyxJQUFJLGFBQUosRUFBYjs7Ozs7Ozs7Ozs7Ozs7OztBQ0ZBLElBQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxjQUFULFNBQ25CLE9BRG1CLENBRW5CLGFBRm1CLFNBQXRCOztJQUlNLEk7QUFDSixnQkFBWSxJQUFaLEVBQWtCO0FBQUE7O0FBQ2hCLFNBQUssSUFBTCxHQUFZLElBQVo7QUFDRDs7Ozs4QkFFUztBQUNSLFVBQU0sSUFBSSxHQUFHLGFBQWEsQ0FBQyxTQUFkLENBQXdCLElBQXhCLENBQWI7QUFDQSxNQUFBLElBQUksQ0FBQyxhQUFMLGVBQWlDLEdBQWpDLGlCQUE4QyxLQUFLLElBQW5EO0FBQ0EsYUFBTyxJQUFQO0FBQ0Q7Ozs7OztlQUdZLEk7Ozs7Ozs7Ozs7QUNoQlIsSUFBTSxZQUFZLEdBQUcsaWFBQXJCOzs7Ozs7Ozs7OztBQ0FQOztBQUNBOztBQUNBOzs7Ozs7Ozs7O0FBRUEsSUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLGNBQVQsUUFBZDtBQUNBLElBQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxjQUFULGFBQWxCO0FBQ0EsSUFBTSxXQUFXLEdBQUcsU0FBUyxDQUFDLGdCQUFWLDJCQUFwQjtBQUNBLElBQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxjQUFULGNBQW5COztJQUVNLEk7QUFDSixrQkFBYztBQUFBOztBQUNaLFNBQUssSUFBTCxHQUFZLENBQVo7QUFDQSxTQUFLLFNBQUwsR0FBaUIsSUFBakI7QUFDQSxTQUFLLFNBQUws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Ozs7NkJBRVEsQyxFQUFHO0FBQUE7O0FBQ1YsTUFBQSxDQUFDLENBQUMsY0FBRjtBQUNBLE1BQUEsV0FBVyxDQUFDLE9BQVosQ0FBb0IsVUFBQyxTQUFELEVBQWU7QUFDakMsWUFBSSxTQUFTLENBQUMsT0FBZCxFQUF1QjtBQUNyQixVQUFBLE1BQUksQ0FBQyxJQUFMLEdBQVksQ0FBQyxTQUFTLENBQUMsS0FBdkI7QUFDRDtBQUNGLE9BSkQ7QUFNQSxXQUFLLFFBQUw7QUFDQSxXQUFLLHNCQUFMO0FBQ0EsTUFBQSxLQUFLLENBQUMsU0FBTixDQUFnQixHQUFoQjtBQUNEOzs7NkNBRXdCO0FBQUE7O0FBQ3ZCLE1BQUEsVUFBVSxDQUFDLGdCQUFYLFVBQXFDLE9BQXJDLENBQTZDLFVBQUMsSUFBRCxFQUFVO0FBQ3JELFFBQUEsSUFBSSxDQUFDLGdCQUFMLFVBQStCLE1BQUksQ0FBQyxXQUFMLENBQWlCLElBQWpCLENBQXNCLE1BQXRCLENBQS9CO0FBQ0QsT0FGRDtBQUdEOzs7d0NBRW1CO0FBQ2xCLE1BQUEsU0FBUyxDQUFDLGdCQUFWLFdBQXFDLEtBQUssUUFBTCxDQUFjLElBQWQsQ0FBbUIsSUFBbkIsQ0FBckM7QUFDRDs7Ozs7O2VBR1ksSTs7Ozs7Ozs7Ozs7QUNsSFIsSUFBTSxjQUFjLEdBQUcsU0FBakIsY0FBaUIsQ0FBQyxHQUFELEVBQVM7QUFDckMsU0FBTyxHQUFHLENBQUMsSUFBSixDQUFTLFlBQVk7QUFDMUIsV0FBTyxJQUFJLENBQUMsTUFBTCxLQUFnQixHQUF2QjtBQUNELEdBRk0sQ0FBUDtBQUdELENBSk0iLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgR2FtZSBmcm9tICcuL21vZHVsZXMvZ2FtZS5qcyc7XG5cbmNvbnN0IGdhbWUgPSBuZXcgR2FtZSgpO1xuIiwiY29uc3QgJGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYXJkYClcbiAgLmNvbnRlbnRcbiAgLnF1ZXJ5U2VsZWN0b3IoYC5jYXJkYCk7XG5cbmNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIGdldENhcmQoKSB7XG4gICAgY29uc3Qgbm9kZSA9ICRjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICAgIG5vZGUucXVlcnlTZWxlY3RvcihgLmNhcmRfX2ltZ2ApLnNyYyA9IGBpbWcvJHt0aGlzLm5hbWV9YDtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiZXhwb3J0IGNvbnN0IElNQUdFU19OQU1FUyA9IFtcbiAgYGFwcGxlLnN2Z2AsXG4gIGBiYWxsLnN2Z2AsXG4gIGBiYW5hbmEuc3ZnYCxcbiAgYGNha2Uuc3ZnYCxcbiAgYGNhci5zdmdgLFxuICBgY2F0LnN2Z2AsXG4gIGBjbG91ZC5zdmdgLFxuICBgZG9nLnN2Z2AsXG4gIGBkdWNrLnN2Z2AsXG4gIGBlYXJ0aC5zdmdgLFxuICBgZmVycmlzLnN2Z2AsXG4gIGBmcmlnLnN2Z2AsXG4gIGBmbGFnLnN2Z2AsXG4gIGBmcm9nLnN2Z2AsXG4gIGBoYXQuc3ZnYCxcbiAgYGhvdC1kb2cuc3ZnYCxcbiAgYGhvdXNlLnN2Z2AsXG4gIGBsZWFmLnN2Z2AsXG4gIGBsaWdodG5pbmcuc3ZnYCxcbiAgYG1vb24uc3ZnYCxcbiAgYG11c3RhY2hlLnN2Z2AsXG4gIGByYWluYm93LnN2Z2AsXG4gIGByb2FkLnN2Z2AsXG4gIGByb2NrZXQuc3ZnYCxcbiAgYHNoaXAuc3ZnYCxcbiAgYHNtaWxlLnN2Z2AsXG4gIGBzdGFyLnN2Z2AsXG4gIGBzdW4uc3ZnYCxcbiAgYHRyZWUuc3ZnYCxcbiAgYHQtc2hpcnQuc3ZnYCxcbiAgYHR2LXNjcmVlbi5zdmdgLFxuICBgdW1icmVsbGEuc3ZnYFxuXTtcbiIsImltcG9ydCB7SU1BR0VTX05BTUVTfSBmcm9tICcuL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQge2dldFNodWZmbGVkQXJyfSBmcm9tICcuLi91dGlscy9yYW5kb20uanMnO1xuaW1wb3J0IENhcmQgZnJvbSAnLi9jYXJkLmpzJztcblxuY29uc3QgJG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgbWVudWApO1xuY29uc3QgJG1lbnVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYG1lbnUtZm9ybWApO1xuY29uc3QgJHNpemVzUmFkaW8gPSAkbWVudUZvcm0ucXVlcnlTZWxlY3RvckFsbChgaW5wdXRbbmFtZT0nZmllbGRTaXplJ11gKTtcbmNvbnN0ICRjYXJkQmxvY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY2FyZC1ibG9ja2ApO1xuXG5jbGFzcyBHYW1lIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zaXplID0gNDtcbiAgICB0aGlzLmlzT2RkTW92ZSA9IHRydWU7XG4gICAgdGhpcy5maXJzdENhcmQgPSB7fTtcbiAgICB0aGlzLmlzRGVib3VuY2UgPSBmYWxzZTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBhZGRDYXJkcygpIHtcbiAgICAkY2FyZEJsb2NrLmlubmVySFRNTCA9IGBgO1xuICAgIGNvbnN0IHggPSB0aGlzLnNpemU7XG4gICAgY29uc3Qgc2h1ZmZsZWRBcnIgPSBnZXRTaHVmZmxlZEFycihJTUFHRVNfTkFNRVMpLnNsaWNlKDAsIHggKiB4IC8gMik7XG4gICAgY29uc3QgY2FyZHNBcnIgPSBbXTtcbiAgICBzaHVmZmxlZEFyci5mb3JFYWNoKChuYW1lLCBpZHgpID0+IHtcbiAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChuYW1lKS5nZXRDYXJkKCk7XG4gICAgICBjYXJkLnNldEF0dHJpYnV0ZShgZGF0YS1wYWlySWRgLCBpZHgpO1xuICAgICAgY2FyZHNBcnIucHVzaChjYXJkKTtcbiAgICAgIGNvbnN0IGNvcHlDYXJkID0gY2FyZC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBjYXJkc0Fyci5wdXNoKGNvcHlDYXJkKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGdldFNodWZmbGVkQXJyKGNhcmRzQXJyKS5mb3JFYWNoKChjYXJkLCBpZHgpID0+IHtcbiAgICAgIGNhcmQuc2V0QXR0cmlidXRlKGBkYXRhLWlkYCwgaWR4KTtcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGNhcmQpO1xuICAgIH0pO1xuXG4gICAgJGNhcmRCbG9jay5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgJGNhcmRCbG9jay5jbGFzc0xpc3QuYWRkKGBzaXplLSR7eH1gKTtcbiAgfVxuXG4gIG9uQ2FyZENsaWNrKGUpIHtcbiAgICBjb25zdCBjYXJkID0gZS5jdXJyZW50VGFyZ2V0O1xuXG4gICAgaWYgKGNhcmQuY2xhc3NMaXN0LmNvbnRhaW5zKGBkb25lYCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0RlYm91bmNlID09PSB0cnVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNPZGRNb3ZlKSB7XG4gICAgICB0aGlzLmZpcnN0Q2FyZCA9IGNhcmQ7XG4gICAgICBjYXJkLmNsYXNzTGlzdC5hZGQoYGRvbmVgKTtcbiAgICAgIHRoaXMuaXNPZGRNb3ZlID0gZmFsc2U7XG4gICAgICB0aGlzLm1ha2VEZWJvdW5jZSg2MDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYXJkLmNsYXNzTGlzdC5hZGQoYGRvbmVgKTtcbiAgICAgIGlmIChjYXJkLmdldEF0dHJpYnV0ZShgZGF0YS1wYWlyaWRgKSAhPT0gdGhpcy5maXJzdENhcmQuZ2V0QXR0cmlidXRlKGBkYXRhLXBhaXJpZGApKSB7XG4gICAgICAgIHRoaXMuaGlkZUJvdGhDYXJkcyhjYXJkKTtcbiAgICAgICAgdGhpcy5tYWtlRGVib3VuY2UoMTIwMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1ha2VEZWJvdW5jZSg2MDApO1xuICAgICAgICBjYXJkLmNsYXNzTGlzdC5hZGQoYG9wZW5lZGApO1xuICAgICAgICB0aGlzLmZpcnN0Q2FyZC5jbGFzc0xpc3QuYWRkKGBvcGVuZWRgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaXNPZGRNb3ZlID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBtYWtlRGVib3VuY2UodGltZSkge1xuICAgIHRoaXMuaXNEZWJvdW5jZSA9IHRydWU7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuaXNEZWJvdW5jZSA9IGZhbHNlO1xuICAgIH0sIHRpbWUpO1xuICB9XG5cbiAgaGlkZUJvdGhDYXJkcyhjdXJyZW50Q2FyZCkge1xuICAgIHJldHVybiBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGN1cnJlbnRDYXJkLmNsYXNzTGlzdC5yZW1vdmUoYGRvbmVgKTtcbiAgICAgIHRoaXMuZmlyc3RDYXJkLmNsYXNzTGlzdC5yZW1vdmUoYGRvbmVgKTtcbiAgICB9LCA2MDApO1xuICB9XG5cbiAgZ2V0Q2FyZEJ5SWQoaWQpIHtcbiAgICByZXR1cm4gJGNhcmRCbG9jay5xdWVyeVNlbGVjdG9yQWxsKGAuY2FyZGApW2lkXTtcbiAgfVxuXG4gIG9uU3VibWl0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgJHNpemVzUmFkaW8uZm9yRWFjaCgoc2l6ZVJhZGlvKSA9PiB7XG4gICAgICBpZiAoc2l6ZVJhZGlvLmNoZWNrZWQpIHtcbiAgICAgICAgdGhpcy5zaXplID0gK3NpemVSYWRpby52YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuYWRkQ2FyZHMoKTtcbiAgICB0aGlzLmFkZENhcmRzRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAkbWVudS5jbGFzc0xpc3QuYWRkKGBoaWRkZW5gKTtcbiAgfVxuXG4gIGFkZENhcmRzRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgJGNhcmRCbG9jay5xdWVyeVNlbGVjdG9yQWxsKGAuY2FyZGApLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCB0aGlzLm9uQ2FyZENsaWNrLmJpbmQodGhpcykpO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgJG1lbnVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoYHN1Ym1pdGAsIHRoaXMub25TdWJtaXQuYmluZCh0aGlzKSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgR2FtZTtcbiIsImV4cG9ydCBjb25zdCBnZXRTaHVmZmxlZEFyciA9IChhcnIpID0+IHtcbiAgcmV0dXJuIGFyci5zb3J0KGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAtIDAuNTtcbiAgfSk7XG59O1xuIl19"}